# Building a Product Service API with Claude 3.7 SonnetÂ ðŸ¤–

Welcome to the Product Service API project! This repo houses the entire project generated by [Claude 3.7 Sonnet](https://www.anthropic.com/news/claude-3-7-sonnet) using the [Visual Studio Code](https://code.visualstudio.com/) [Cline plugin](https://cline.bot/) and [AWS Bedrock](https://aws.amazon.com/bedrock/) integration.

It pairs with the blog post ["Building a Product Service API with Claude 3.7 Sonnet ðŸ¤–"](https://jcdubs.medium.com/building-a-product-service-api-with-claude-3-7-sonnet-c8d22dfe7131) to show you just whatâ€™s possible with a few simple instructions and Claude 3.7 Sonnet.

In the blog post, you'll see the initial Cline window output where the project plan was defined and executed. To keep things concise there, the later Cline outputsâ€”showing subsequent instructions sent to Claudeâ€”are saved here in the `cline-output` directory as markdown files.

1. [Initial Project Plan](./cline-output/1-project-plan.md)
2. [Updated Project Plan](./cline-output/2-project-plan-update.md)
3. [Project Plan Act Mode](./cline-output/3-project-act-mode.md)
4. [Change to Lamnda Construct to use the Node.js CDK Lambda Construct](./cline-output/4-lambda-construct-alteration.md)
5. [Modifiction to use version 3 of the AWS SDK](./cline-output/5-aws-sdk-modification.md)
6. [CloudWatch Dashboard alarm changes](./cline-output/6-cloudwatch-dashboard-alarms-changes.md)
7. [CloudWatch Dashboard DynamoDB changes](./cline-output/7-cloudwatch-dashboard-dynamo-alarms-changes.md)
8. [Fixing unit test failures](./cline-output/8-unit-test-failures.md)
9. [Improving unit test code coverage](./cline-output/9-unit-test-code-coverage.md)
10. [Postman test output](./cline-output/10-postman-tests.md)

THE REMAINDER OF THIS README PAGE WAS GENERATED BY CLAUDE 3.7 SONNET AS THE PROJECT README FILE.

----------------------------------------------------------------------------------------------

# Product Service API

A serverless API for managing products, built with AWS CDK, following clean architecture principles and implementing the Microsoft Common Data Model for products.

## Architecture

This project implements a serverless architecture using AWS services:

- **API Gateway**: RESTful API endpoints
- **Lambda**: Business logic and request handling using NodeJS Lambda construct with esbuild
- **DynamoDB**: Data storage using single-table design
- **Cognito**: Authentication and authorization
- **CloudWatch**: Monitoring and alerting

The codebase follows clean architecture principles with a clear separation of concerns:

```
/lib
  /core              # Domain models, interfaces, business logic
  /adapters          # External adapters (DynamoDB, etc.)
  /handlers          # Lambda handlers
  /validation        # Validation schemas
  /constructs        # CDK constructs
```

## Features

- Complete CRUD operations for products
- Microsoft Common Data Model implementation
- OAuth2 authentication with Amazon Cognito
- Strict validation using Joi
- Single-table DynamoDB design
- AWS SDK v3 for improved modularity and reduced bundle size
- Comprehensive monitoring with CloudWatch alarms and dashboard for API Gateway, Lambda, and DynamoDB
- Lambda functions bundled with esbuild for optimal performance
- Unit tests with Jest
- End-to-end tests with Postman/Newman

## Prerequisites

- Node.js 18.x or later
- AWS CLI configured with appropriate credentials
- AWS CDK installed globally (`npm install -g aws-cdk`)

## Installation

1. Clone the repository
2. Install dependencies:

```bash
npm install
```

3. Build the project:

```bash
npm run build
```

## Deployment

1. Bootstrap your AWS environment (if not already done):

```bash
cdk bootstrap
```

2. Deploy the stack:

```bash
npm run deploy
```

## Testing

### Unit Tests

Run the unit tests:

```bash
npm test
```

### End-to-End Tests

1. Update the Postman environment variables in `test/e2e/environment.json` with your deployed API details.
2. Run the Postman collection using Newman:

```bash
npm run postman
```

## API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | /products | Create a new product |
| GET | /products | List products with optional filtering |
| GET | /products/{id} | Get a product by ID |
| PUT | /products/{id} | Update a product |
| DELETE | /products/{id} | Delete a product |

## Authentication

The API uses Amazon Cognito for authentication. To access the API:

1. Create a user in the Cognito User Pool
2. Obtain an ID token using the Cognito authentication flow
3. Include the ID token in the `Authorization` header as a Bearer token

## Product Model

The product model follows the Microsoft Common Data Model and includes:

- Basic information (name, description)
- Categorization (productType, productCategory)
- Identification (SKU, GTIN)
- Pricing information
- Physical attributes (dimensions, weight)
- Media references
- Related products

## Development

### Project Structure

- `bin/`: CDK app entry point
- `lib/`: Main source code
  - `core/`: Domain models and business logic
  - `adapters/`: External adapters (e.g., DynamoDB)
  - `handlers/`: Lambda function handlers
  - `validation/`: Input validation schemas
  - `constructs/`: CDK infrastructure constructs
- `test/`: Test files
  - `unit/`: Unit tests
  - `e2e/`: End-to-end tests with Postman

### Adding New Features

1. Define domain models in `lib/core/models/`
2. Create repository interfaces in `lib/core/ports/`
3. Implement use cases in `lib/core/use-cases/`
4. Add validation schemas in `lib/validation/`
5. Implement adapters in `lib/adapters/`
6. Create Lambda handlers in `lib/handlers/`
7. Update CDK constructs in `lib/constructs/`
8. Add tests in `test/`

## License

MIT
